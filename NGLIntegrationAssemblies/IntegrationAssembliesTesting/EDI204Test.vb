Imports System
Imports Tar = Ngl.FM.CarTar
Imports DAL = Ngl.FreightMaster.Data
Imports DTO = Ngl.FreightMaster.Data.DataTransferObjects
Imports BLL = Ngl.FM.BLL
Imports LTS = Ngl.FreightMaster.Data.LTS
Imports Ngl.FreightMaster.Integration

<TestClass()> Public Class EDI204Test
    Inherits TestBase

    ''<TestMethod()>
    ''Public Sub TestParseEDI204InString()
    ''    Dim oConfig As New Ngl.FreightMaster.Core.UserConfiguration()
    ''    With oConfig
    ''        .AdminEmail = "rramsey@nextgeneration.com"
    ''        .AutoRetry = 0
    ''        .Database = "NGLMASDEV7051"
    ''        .DBServer = "ROBWIN8LAP\SQL2016"
    ''        .Debug = True
    ''        .FromEmail = "rramsey@nextgeneration.com"
    ''        .GroupEmail = "rramsey@nextgeneration.com"
    ''        .KeepLogDays = 1
    ''        .LogFile = "C:\Data\TMSLog.txt"
    ''        .SaveOldLog = False
    ''        .SMTPServer = "nglMail.nextgeneration.com"
    ''        .Source = "EDI204UnitTest"
    ''    End With
    ''    Dim strResults As String = "Fail"
    ''    Dim oEDI204In As New Ngl.FreightMaster.Integration.clsEDI204In(oConfig)
    ''    Dim strData = "ST*204*6~B2**NGLT**WSHU000229**PP~B2A*00~L11*SO148416*CO~G62*45*20170503~PLD*26~N1*BT*PALERMO VILLA INC (D-U-N-S+4: 1447434080000)*91*240~N3*3301 W CANAL STREET~N4*MILWAUKEE*WI*53208~G61*CN*ACCOUNTS PAYABLE*TE*414-643-0919~N7**TBD*********FF~S5*1*LD~L11*SO148415*CO~G62*10*20170425~N1*SF*CSW - PLEASANT PRAIRIE*91*240~N3*7800 95TH STREET~N4*PLEASANT PRAIRIE*WI*53158~G61*CN*CSW - PLEASANT PRAIRIE*TE*1-262-947-7800~OID*15202***CA*104*L*0~LAD*************SS STROMBOLI SUPREME 2PK~L5*1*SCREAMIN' SICILIAN STROMBOLI~AT8****104*1~OID*15203***CA*104*L*0~LAD*************SS STROMBOLI PESTO CHICKEN 2PK~L5*1*SCREAMIN' SICILIAN STROMBOLI~AT8****104*1~OID*15200***CA*104*L*0~LAD*************SS STROMBOLI PEPPERONI 2PK~L5*1*SCREAMIN' SICILIAN STROMBOLI~AT8****104*1~OID*15201***CA*104*L*0~LAD*************SS STROMBOLI COMBO 2PK~L5*1*SCREAMIN' SICILIAN STROMBOLI~AT8****104*1~OID*15101***CA*42*L*702.45~LAD*************11.5IN SS CHOPPED PEP~L5*1*SCREAMIN SICILIAN~AT8****42*1~OID*15300***CA*48*L*736.32~LAD*************11.25IN PE SUPREME MD~L5*1*URBAN PIE~AT8****48*1~OID*15301***CA*48*L*608.64~LAD*************11.25IN PE PESTO TOMATO LI~L5*1*URBAN PIE~AT8****48*1~OID*15303***CA*96*L*1231.68~LAD*************11.25IN PE TRUFFLE MSHRM NE~L5*2*URBAN PIE~AT8****96*2~S5*2*LD~L11*SO148416*CO~G62*10*20170425~N1*SF*CSW - PLEASANT PRAIRIE*91*240~N3*7800 95TH STREET~N4*PLEASANT PRAIRIE*WI*53158~G61*CN*CSW - PLEASANT PRAIRIE*TE*1-262-947-7800~OID*23516***CA*180*L*3821.4~LAD*************12IN RC PEPPERONI 3PK~L5*3*AHOLD~AT8****180*3~OID*23531***CA*360*L*5778~LAD*************11.5IN TC COMBO~L5*5*AHOLD~AT8****360*5~OID*23708***CA*384*L*7964.16~LAD*************12IN RC JALAPENO POPPER~L5*8*AHOLD~AT8****384*8~OID*23517***CA*60*L*1269~LAD*************12IN RC CHEESE 3PK~L5*1*AHOLD~AT8****60*1~S5*3*UL~G62*68*20170519~N1*ST*C&S Westfield*91*S00643~N3*53 Summit Lock Rd~N4*Westfield*MA*01085~OID*15202***CA*104*L*0~LAD*************SS STROMBOLI SUPREME 2PK~L5*1*SCREAMIN' SICILIAN STROMBOLI~AT8****104*1~OID*15203***CA*104*L*0~LAD*************SS STROMBOLI PESTO CHICKEN 2PK~L5*1*SCREAMIN' SICILIAN STROMBOLI~AT8****104*1~OID*15200***CA*104*L*0~LAD*************SS STROMBOLI PEPPERONI 2PK~L5*1*SCREAMIN' SICILIAN STROMBOLI~AT8****104*1~OID*15201***CA*104*L*0~LAD*************SS STROMBOLI COMBO 2PK~L5*1*SCREAMIN' SICILIAN STROMBOLI~AT8****104*1~OID*15101***CA*42*L*702.45~LAD*************11.5IN SS CHOPPED PEP~L5*1*SCREAMIN SICILIAN~AT8****42*1~OID*15300***CA*48*L*736.32~LAD*************11.25IN PE SUPREME MD~L5*1*URBAN PIE~AT8****48*1~OID*15301***CA*48*L*608.64~LAD*************11.25IN PE PESTO TOMATO LI~L5*1*URBAN PIE~AT8****48*1~OID*15303***CA*96*L*1231.68~LAD*************11.25IN PE TRUFFLE MSHRM NE~L5*2*URBAN PIE~AT8****96*2~S5*4*UL~G62*68*20170519~N1*ST*C&S Westfield*91*S00643~N3*53 Summit Lock Rd~N4*Westfield*MA*01085~OID*23516***CA*180*L*3821.4~LAD*************12IN RC PEPPERONI 3PK~L5*3*AHOLD~AT8****180*3~OID*23531***CA*360*L*5778~LAD*************11.5IN TC COMBO~L5*5*AHOLD~AT8****360*5~OID*23708***CA*384*L*7964.16~LAD*************12IN RC JALAPENO POPPER~L5*8*AHOLD~AT8****384*8~OID*23517***CA*60*L*1269~LAD*************12IN RC CHEESE 3PK~L5*1*AHOLD~AT8****60*1~L3*22111.65*G~SE*133*0006"
    ''    Dim strElements = strData.Split("~")
    ''    Dim o204Data As New Ngl.FreightMaster.Integration.clsEDI204In(oConfig)
    ''    Dim intIndex As Integer = 0
    ''    oEDI204In.insertElements(o204Data, strElements, intIndex)
    ''    If Not o204Data Is Nothing Then
    ''        strResults = "Success"
    ''    End If


    ''End Sub


    ''<TestMethod()>
    ''Public Sub TestProcessEDI204InString()
    ''    Dim oConfig As New Ngl.FreightMaster.Core.UserConfiguration()
    ''    With oConfig
    ''        .AdminEmail = "rramsey@nextgeneration.com"
    ''        .AutoRetry = 0
    ''        .Database = "NGLMASDEV7051"
    ''        .DBServer = "ROBWIN8LAP\SQL2016"
    ''        .Debug = True
    ''        .FromEmail = "rramsey@nextgeneration.com"
    ''        .GroupEmail = "rramsey@nextgeneration.com"
    ''        .KeepLogDays = 1
    ''        .LogFile = "C:\Data\TMSLog.txt"
    ''        .SaveOldLog = False
    ''        .SMTPServer = "nglMail.nextgeneration.com"
    ''        .Source = "EDI204UnitTest"
    ''        .WCFAuthCode = "NGLSystem"
    ''        .WSAuthCode = "WSDEV"
    ''        .ConnectionString = "Server=ROBWIN8LAP\SQL2016;User ID=nglweb;Password=5529;Database=NGLMASDEV7051"
    ''        '.ConnectionString = "Data Source=NGLRDP07D;Initial Catalog=NGLMASPROD;User ID=nglweb;Password=5529;"
    ''    End With
    ''    Dim strResults As String = "Fail"
    ''    Dim oEDIInbound As New Ngl.FreightMaster.Integration.clsEDIInput(oConfig)
    ''    'test 1
    ''    Dim strData As New List(Of String)
    ''    'strData.add("ISA*00*          *00*          *12*4146430919AS2  *ZZ*NGL            *170514*2306*U*00401*000000016*0*P*>~GS*SM*4146430919AS2*NGL*20170514*2306*16*X*004010~ST*204*0016~B2**NGLT**WSHU000360**PP~B2A*00~L11*SO148594*CO~L11*23290*PO~G62*45*20170512~PLD*2~N1*BT*PALERMO VILLA INC. (D-U-N-S+4: 1447434080000)*91*240~N3*3301 WEST CANAL STREET~N4*MILWAUKEE*WI*53208~G61*CN*ACCOUNTS PAYABLE*TE*414-643-0919~N7**TBD*********FF~S5*1*LD~L11*SO148594*CO~G62*10*20170512~N1*SF*CSW - PLEASANT PRAIRIE*91*240~N3*7800 95TH STREET~N4*PLEASANT PRAIRIE*WI*53158~G61*CN*CSW - PLEASANT PRAIRIE*TE*1-262-947-7800~OID*16501***CA*60*L*663.78~LAD*************12IN PT PEPPERONI - SE~L5*1*PALERMO'S~AT8****60*1~OID*16502***CA*60*L*744.78~LAD*************12IN PT SUPREME~L5*1*PALERMO'S~AT8****60*1~S5*2*UL~L11*23290*PO~G62*68*20170514~N1*ST*Food City C/O Mid Mountain*91*S01046~N3*26331 Hillmann Hwy~N4*Abingdon*VA*24210~OID*16501***CA*60*L*663.78~LAD*************12IN PT PEPPERONI - SE~L5*1*PALERMO'S~AT8****60*1~OID*16502***CA*60*L*744.78~LAD*************12IN PT SUPREME~L5*1*PALERMO'S~AT8****60*1~L3*1408.56*G~SE*43*0016~GE*1*16~IEA*1*000000016~")
    ''    ''test 2
    ''    'strData.Add("ISA*00*          *00*          *12*4146430919AS2  *ZZ*NGL            *170514*2305*U*00401*000000012*0*P*>~GS*SM*4146430919AS2*NGL*20170514*2305*12*X*004010~ST*204*0012~B2**NGLT**WSHU000353**PP~B2A*00~L11*SO148584*CO~L11*78793*PO~G62*45*20170512~PLD*7~N1*BT*PALERMO VILLA INC. (D-U-N-S+4: 1447434080000)*91*240~N3*3301 WEST CANAL STREET~N4*MILWAUKEE*WI*53208~G61*CN*ACCOUNTS PAYABLE*TE*414-643-0919~N7**TBD*********FF~S5*1*LD~L11*SO148584*CO~G62*10*20170512~N1*SF*CSW - PLEASANT PRAIRIE*91*240~N3*7800 95TH STREET~N4*PLEASANT PRAIRIE*WI*53158~G61*CN*CSW - PLEASANT PRAIRIE*TE*1-262-947-7800~OID*15106***CA*42*L*636.3~LAD*************11.5IN SS BBQ 3 MEAT~L5*1*SCREAMIN SICILIAN~AT8****42*1~OID*15101***CA*126*L*2107.35~LAD*************11.5IN SS CHOPPED PEP~L5*3*SCREAMIN SICILIAN~AT8****126*3~OID*15103***CA*126*L*2362.5~LAD*************11.5IN SS SUPREME~L5*3*SCREAMIN SICILIAN~AT8****126*3~S5*2*UL~L11*78793*PO~G62*68*20170512~N1*ST*Associated Wholesale Grocers Springfield*91*S05935~N3*3201 East Division Street~N4*Springfield*MO*65802~OID*15106***CA*42*L*636.3~LAD*************11.5IN SS BBQ 3 MEAT~L5*1*SCREAMIN SICILIAN~AT8****42*1~OID*15101***CA*126*L*2107.35~LAD*************11.5IN SS CHOPPED PEP~L5*3*SCREAMIN SICILIAN~AT8****126*3~OID*15103***CA*126*L*2362.5~LAD*************11.5IN SS SUPREME~L5*3*SCREAMIN SICILIAN~AT8****126*3~L3*5106.15*G~SE*51*0012~GE*1*12~IEA*1*000000012~")
    ''    ''test 3
    ''    'strData.Add("ISA*00*          *00*          *12*4146430919AS2  *ZZ*NGL            *170514*2306*U*00401*000000014*0*P*>~GS*SM*4146430919AS2*NGL*20170514*2306*14*X*004010~ST*204*0014~B2**NGLT**WSHU000357**PP~B2A*00~L11*SO148587*CO~L11*434639*PO~G62*45*20170512~PLD*15~N1*BT*PALERMO VILLA INC. (D-U-N-S+4: 1447434080000)*91*240~N3*3301 WEST CANAL STREET~N4*MILWAUKEE*WI*53208~G61*CN*ACCOUNTS PAYABLE*TE*414-643-0919~N7**TBD*********FF~S5*1*LD~L11*SO148587*CO~G62*10*20170512~N1*SF*CSW - PLEASANT PRAIRIE*91*240~N3*7800 95TH STREET~N4*PLEASANT PRAIRIE*WI*53158~G61*CN*CSW - PLEASANT PRAIRIE*TE*1-262-947-7800~OID*23065***CA*96*L*2188.8~LAD*************12IN RC 3 MEAT~L5*2*MARKET BASKET~AT8****96*2~OID*23066***CA*288*L*6091.2~LAD*************12IN RC 4 CHEESE~L5*6*MARKET BASKET~AT8****288*6~OID*23067***CA*192*L*4076.16~LAD*************12IN RC PEPPERONI~L5*4*MARKET BASKET~AT8****192*4~OID*23068***CA*144*L*3530.88~LAD*************12IN RC SUPREME~L5*3*MARKET BASKET~AT8****144*3~S5*2*UL~L11*434639*PO~G62*68*20170514~N1*ST*C&S Brattleboro*91*S00634~N3*Old Ferry Rd~N4*Brattleboro*VT*05301~OID*23065***CA*96*L*2188.8~LAD*************12IN RC 3 MEAT~L5*2*MARKET BASKET~AT8****96*2~OID*23066***CA*288*L*6091.2~LAD*************12IN RC 4 CHEESE~L5*6*MARKET BASKET~AT8****288*6~OID*23067***CA*192*L*4076.16~LAD*************12IN RC PEPPERONI~L5*4*MARKET BASKET~AT8****192*4~OID*23068***CA*144*L*3530.88~LAD*************12IN RC SUPREME~L5*3*MARKET BASKET~AT8****144*3~L3*15887.04*G~SE*59*0014~GE*1*14~IEA*1*000000014~")
    ''    ''tst 4
    ''    'strData.Add("ISA*00*          *00*          *12*4146430919AS2  *ZZ*NGL            *170514*2306*U*00401*000000015*0*P*>~GS*SM*4146430919AS2*NGL*20170514*2306*15*X*004010~ST*204*0015~B2**NGLT**WSHU000358**PP~B2A*00~L11*SO148591*CO~L11*05366482*PO~G62*45*20170512~PLD*5~N1*BT*PALERMO VILLA INC. (D-U-N-S+4: 1447434080000)*91*240~N3*3301 WEST CANAL STREET~N4*MILWAUKEE*WI*53208~G61*CN*ACCOUNTS PAYABLE*TE*414-643-0919~N7**TBD*********FF~S5*1*LD~L11*SO148591*CO~G62*10*20170512~N1*SF*CSW - PLEASANT PRAIRIE*91*240~N3*7800 95TH STREET~N4*PLEASANT PRAIRIE*WI*53158~G61*CN*CSW - PLEASANT PRAIRIE*TE*1-262-947-7800~OID*15100***CA*84*L*1310.4~LAD*************11.5IN SS FRESH MOZZ~L5*2*SCREAMIN SICILIAN~AT8****84*2~OID*15102***CA*42*L*740.25~LAD*************11.5IN SS IT COMBO~L5*1*SCREAMIN SICILIAN~AT8****42*1~OID*15103***CA*84*L*1575~LAD*************11.5IN SS SUPREME~L5*2*SCREAMIN SICILIAN~AT8****84*2~S5*2*UL~L11*05366482*PO~G62*68*20170514~N1*ST*Food Lion Salisbury*91*S00683~N3*2085 Harrison Rd Frozen~N4*Salisbury*NC*28144~OID*15100***CA*84*L*1310.4~LAD*************11.5IN SS FRESH MOZZ~L5*2*SCREAMIN SICILIAN~AT8****84*2~OID*15102***CA*42*L*740.25~LAD*************11.5IN SS IT COMBO~L5*1*SCREAMIN SICILIAN~AT8****42*1~OID*15103***CA*84*L*1575~LAD*************11.5IN SS SUPREME~L5*2*SCREAMIN SICILIAN~AT8****84*2~L3*3625.65*G~SE*51*0015~GE*1*15~IEA*1*000000015~")
    ''    ''test 5
    ''    'strData.Add("ISA*00*          *00*          *12*4146430919AS2  *ZZ*NGL            *170514*2306*U*00401*000000016*0*P*>~GS*SM*4146430919AS2*NGL*20170514*2306*16*X*004010~ST*204*0016~B2**NGLT**WSHU000360**PP~B2A*00~L11*SO148594*CO~L11*23290*PO~G62*45*20170512~PLD*2~N1*BT*PALERMO VILLA INC. (D-U-N-S+4: 1447434080000)*91*240~N3*3301 WEST CANAL STREET~N4*MILWAUKEE*WI*53208~G61*CN*ACCOUNTS PAYABLE*TE*414-643-0919~N7**TBD*********FF~S5*1*LD~L11*SO148594*CO~G62*10*20170512~N1*SF*CSW - PLEASANT PRAIRIE*91*240~N3*7800 95TH STREET~N4*PLEASANT PRAIRIE*WI*53158~G61*CN*CSW - PLEASANT PRAIRIE*TE*1-262-947-7800~OID*16501***CA*60*L*663.78~LAD*************12IN PT PEPPERONI - SE~L5*1*PALERMO'S~AT8****60*1~OID*16502***CA*60*L*744.78~LAD*************12IN PT SUPREME~L5*1*PALERMO'S~AT8****60*1~S5*2*UL~L11*23290*PO~G62*68*20170514~N1*ST*Food City C/O Mid Mountain*91*S01046~N3*26331 Hillmann Hwy~N4*Abingdon*VA*24210~OID*16501***CA*60*L*663.78~LAD*************12IN PT PEPPERONI - SE~L5*1*PALERMO'S~AT8****60*1~OID*16502***CA*60*L*744.78~LAD*************12IN PT SUPREME~L5*1*PALERMO'S~AT8****60*1~L3*1408.56*G~SE*43*0016~GE*1*16~IEA*1*000000016~")
    ''    ''test 6
    ''    'strData.Add("ISA*00*          *00*          *12*4146430919AS2  *ZZ*NGL            *170514*2307*U*00401*000000018*0*P*>~GS*SM*4146430919AS2*NGL*20170514*2307*18*X*004010~ST*204*0018~B2**NGLT**WSHU000362**PP~B2A*00~L11*SO148592*CO~L11*14X393225*PO~G62*45*20170512~PLD*25~N1*BT*PALERMO VILLA INC. (D-U-N-S+4: 1447434080000)*91*240~N3*3301 WEST CANAL STREET~N4*MILWAUKEE*WI*53208~G61*CN*ACCOUNTS PAYABLE*TE*414-643-0919~N7**TBD*********FF~S5*1*LD~L11*SO148592*CO~G62*10*20170512~N1*SF*CSW - PLEASANT PRAIRIE*91*240~N3*7800 95TH STREET~N4*PLEASANT PRAIRIE*WI*53158~G61*CN*CSW - PLEASANT PRAIRIE*TE*1-262-947-7800~OID*15105***CA*42*L*688.28~LAD*************11.5IN SS JCBR~L5*1*SCREAMIN SICILIAN~AT8****42*1~OID*15103***CA*84*L*1575~LAD*************11.5IN SS SUPREME~L5*2*SCREAMIN SICILIAN~AT8****84*2~OID*15100***CA*42*L*655.2~LAD*************11.5IN SS FRESH MOZZ~L5*1*SCREAMIN SICILIAN~AT8****42*1~OID*15102***CA*42*L*740.25~LAD*************11.5IN SS IT COMBO~L5*1*SCREAMIN SICILIAN~AT8****42*1~OID*15101***CA*84*L*1404.9~LAD*************11.5IN SS CHOPPED PEP~L5*2*SCREAMIN SICILIAN~AT8****84*2~OID*22763***CA*48*L*1015.2~LAD*************12IN RC 4 CHEESE~L5*1*HEB CLASSIC SELECTIONS~AT8****48*1~OID*22766***CA*96*L*2354.4~LAD*************12IN RC SUPREME~L5*2*HEB CLASSIC SELECTIONS~AT8****96*2~OID*22764***CA*144*L*3056.4~LAD*************12IN RC PEPPERONI~L5*3*HEB CLASSIC SELECTIONS~AT8****144*3~OID*22765***CA*144*L*3294~LAD*************12IN RC 3 MEAT~L5*3*HEB CLASSIC SELECTIONS~AT8****144*3~OID*23682***CA*216*L*3378.24~LAD*************11.5IN TC PEPPERONI~L5*3*HILL COUNTRY FARE~AT8****216*3~OID*23683***CA*144*L*2132.64~LAD*************11.5IN TC COMBO~L5*2*HILL COUNTRY FARE~AT8****144*2~OID*23681***CA*72*L*1077.12~LAD*************11.5IN TC CHEESE~L5*1*HILL COUNTRY FARE~AT8****72*1~OID*23684***CA*144*L*2268~LAD*************11.5IN TC SUPREME~L5*2*HILL COUNTRY FARE~AT8****144*2~OID*15301***CA*48*L*608.64~LAD*************11.25IN PE PESTO TOMATO LI~L5*1*URBAN PIE~AT8****48*1~S5*2*UL~L11*14X393225*PO~G62*68*20170515~N1*ST*HEB Grocery San Antonio*91*S00692~N3*San Antonio Frozen Warehouse~N4*San Antonio*TX*78218~OID*15105***CA*42*L*688.28~LAD*************11.5IN SS JCBR~L5*1*SCREAMIN SICILIAN~AT8****42*1~OID*15103***CA*84*L*1575~LAD*************11.5IN SS SUPREME~L5*2*SCREAMIN SICILIAN~AT8****84*2~OID*15100***CA*42*L*655.2~LAD*************11.5IN SS FRESH MOZZ~L5*1*SCREAMIN SICILIAN~AT8****42*1~OID*15102***CA*42*L*740.25~LAD*************11.5IN SS IT COMBO~L5*1*SCREAMIN SICILIAN~AT8****42*1~OID*15101***CA*84*L*1404.9~LAD*************11.5IN SS CHOPPED PEP~L5*2*SCREAMIN SICILIAN~AT8****84*2~OID*22763***CA*48*L*1015.2~LAD*************12IN RC 4 CHEESE~L5*1*HEB CLASSIC SELECTIONS~AT8****48*1~OID*22766***CA*96*L*2354.4~LAD*************12IN RC SUPREME~L5*2*HEB CLASSIC SELECTIONS~AT8****96*2~OID*22764***CA*144*L*3056.4~LAD*************12IN RC PEPPERONI~L5*3*HEB CLASSIC SELECTIONS~AT8****144*3~OID*22765***CA*144*L*3294~LAD*************12IN RC 3 MEAT~L5*3*HEB CLASSIC SELECTIONS~AT8****144*3~OID*23682***CA*216*L*3378.24~LAD*************11.5IN TC PEPPERONI~L5*3*HILL COUNTRY FARE~AT8****216*3~OID*23683***CA*144*L*2132.64~LAD*************11.5IN TC COMBO~L5*2*HILL COUNTRY FARE~AT8****144*2~OID*23681***CA*72*L*1077.12~LAD*************11.5IN TC CHEESE~L5*1*HILL COUNTRY FARE~AT8****72*1~OID*23684***CA*144*L*2268~LAD*************11.5IN TC SUPREME~L5*2*HILL COUNTRY FARE~AT8****144*2~OID*15301***CA*48*L*608.64~LAD*************11.25IN PE PESTO TOMATO LI~L5*1*URBAN PIE~AT8****48*1~L3*24248.27*G~SE*139*0018~GE*1*18~IEA*1*000000018~")
    ''    'test 7 Purchase Order Inbound Freight with new company
    ''    strData.Add("ISA*00*          *00*          *12*4146430919AS2  *ZZ*NGL            *170516*0807*U*00401*000000019*0*P*>~GS*SM*4146430919AS2*NGL*20170516*0807*19*X*004010~ST*204*0019~B2**NGLT**WRCU000141**PP~B2A*00~L11*PO000137*CO~L11*PO000137*PO~G62*45*20170515~PLD*5~N1*BT*PALERMO VILLA INC. (D-U-N-S+4: 1447434080000)*91*100~N3*3301 WEST CANAL STREET~N4*MILWAUKEE*WI*53208~G61*CN*ACCOUNTS PAYABLE*TE*414-643-0919~N7**TBD*********FF~S5*1*LD~L11*PO000137*CO~G62*10*20170510~N1*SF*LEPRINO FOODS COMPANY*91*V00734~N3*LOCK BOX 774484~N4*CHICAGO*IL*60677-4004~G61*CN*LEPRINO FOODS COMPANY~OID*250002***CA*10000*L*0~LAD*************CHEESE, MOZZ, LMPS~L5*5~AT8****10000*5~S5*2*UL~L11*PO000137*PO~G62*68*20170510~N1*ST*PALERMO VILLA, INC.*91*100~N3*3301 WEST CANAL STREET~N4*MILWAUKEE*WI*53208~OID*250002***CA*10000*L*0~LAD*************CHEESE, MOZZ, LMPS~L5*5~AT8****10000*5~L3*0*G~SE*35*0019~GE*1*19~IEA*1*000000019~")
    ''    'test 8 weight
    ''    'strData.Add("ISA*00*          *00*          *12*4146430919AS2  *ZZ*NGL            *170522*1147*U*00401*000000020*0*P*>~GS*SM*4146430919AS2*NGL*20170522*1147*20*X*004010~ST*204*0020~B2**NGLT**WRCU000145**PP~B2A*00~L11*PO000137*CO~L11*PO000137*PO~G62*45*20170522~PLD*5~N1*BT*PALERMO VILLA INC. (D-U-N-S+4: 1447434080000)*91*100~N3*3301 WEST CANAL STREET~N4*MILWAUKEE*WI*53208~G61*CN*ACCOUNTS PAYABLE*TE*414-643-0919~N7**TBD*********FF~S5*1*LD~L11*PO000137*CO~G62*10*20170510~N1*SF*LEPRINO FOODS COMPANY*91*V00734~N3*LOCK BOX 774484~N4*CHICAGO*IL*60677-4004~G61*CN*LEPRINO FOODS COMPANY~OID*250002***CA*10000*L*10000~LAD*************CHEESE, MOZZ, LMPS~L5*5~AT8****10000*5~S5*2*UL~L11*PO000137*PO~G62*68*20170510~N1*ST*PALERMO VILLA, INC.*91*100~N3*3301 WEST CANAL STREET~N4*MILWAUKEE*WI*53208~OID*250002***CA*10000*L*10000~LAD*************CHEESE, MOZZ, LMPS~L5*5~AT8****10000*5~L3*10000*G~SE*35*0020~GE*1*20~IEA*1*000000020~")
    ''    Dim strTestFile As String = "C:\Users\Rob\Documents\SampleEDIConfig.txt"
    ''    For Each d In strData
    ''        Dim oRet = oEDIInbound.ProcessData(d, oConfig.ConnectionString, 0, "", Date.Now(), strTestFile)
    ''        If oRet = Configuration.ProcessDataReturnValues.nglDataIntegrationComplete Then
    ''            strResults = "Success"
    ''        End If
    ''    Next


    ''End Sub


    ''<TestMethod()>
    ''Public Sub TestReadEDI204Config()
    ''    Dim oSetting As New clsEDISettings()
    ''    Dim strTestFile As String = "C:\Users\Rob\Documents\SampleEDIConfig.txt"
    ''    Dim obj204Setting As clsEDI204InSetting = oSetting.readEDI204InSetting(strTestFile)
    ''    If obj204Setting Is Nothing Then
    ''        Assert.Fail()
    ''    End If



    ''End Sub


    <TestMethod()>
    Public Sub TestProcessEDI204OutString()
        Dim oConfig As New Ngl.FreightMaster.Core.UserConfiguration()
        Dim sDebugEmail As String = "rramsey@nextgeneration.com"
        With oConfig
            .AdminEmail = sDebugEmail
            .AutoRetry = 0
            .Database = "NGLMASKing"
            .DBServer = "DESKTOP-0R0EJUB\SQLEXPRESS01"
            .Debug = True
            .FromEmail = sDebugEmail
            .GroupEmail = sDebugEmail
            .KeepLogDays = 1
            .LogFile = "C:\Data\TMSLogs\TMSLog.txt"
            .SaveOldLog = False
            .SMTPServer = "nglMail.nextgeneration.com"
            .Source = "EDI204UnitTest"
            .WCFAuthCode = "NGLSystem"
            .WSAuthCode = "WSDEV"
            .ConnectionString = "Server=" & .DBServer & ";User ID=nglweb;Password=5529;Database=" & .Database
        End With

        Dim strResults As String = "Fail"

        Dim oEDI204 As New Ngl.FreightMaster.Integration.clsEDI204()

        Dim EDIString = ""
        Dim ConnectionString = oConfig.ConnectionString
        Dim CarrierNumber = "1"
        Dim FileName = "" '"D:\EDI\PVI\OUT\EDI204.txt" 'check this
        Dim sConfigFile = "C:\Data\EDI\TBS\NMTF\Out\EDIConfig.txt"

        Dim strTestFile As String = "C:\Data\EDI\TBS\NMTF\IN\EDIConfig.txt"

        Dim oRet = oEDI204.getTruckLoadEDI204String(EDIString, ConnectionString, CarrierNumber, FileName, sConfigFile:=sConfigFile)
        If oRet = Configuration.ProcessDataReturnValues.nglDataIntegrationComplete Then
            strResults = "Success"
        End If



        'need a load in PB status for carrier 35
        'start with P status and retender also make sure edi settings correct fro carruer 35

    End Sub

End Class
